{
  "version": 3,
  "sources": ["../src/config.js", "../src/styles.js", "../src/trigger.js", "../src/panel.js", "../src/api-bridge.js", "../src/message-handler.js", "../src/sandbox.js", "../src/renderer.js", "../src/history.js", "../src/api-client.js", "../src/index.js"],
  "sourcesContent": ["/**\n * Configuration validation and defaults for the n.codes widget.\n */\n\nconst DEFAULTS = {\n  user: null,\n  apiUrl: '/api/generate',\n  provider: 'openai',\n  model: 'gpt-5-mini',\n  theme: 'dark',\n  position: 'bottom-center',\n  triggerLabel: 'Build with AI',\n  panelTitle: 'n.codes',\n  panelIntro: 'Describe the UI you need and it will be generated instantly.',\n  quickPrompts: [],\n};\n\nconst VALID_THEMES = new Set(['dark', 'light', 'auto']);\nconst VALID_POSITIONS = new Set(['bottom-center', 'bottom-right', 'bottom-left']);\n\nfunction validateConfig(config) {\n  if (!config || typeof config !== 'object') {\n    throw new Error('NCodes.init() requires a config object.');\n  }\n  if (config.mode && config.mode !== 'live') {\n    throw new Error('Simulation mode is no longer supported. Remove mode or set it to \"live\".');\n  }\n  if (config.theme && !VALID_THEMES.has(config.theme)) {\n    throw new Error(`Invalid theme \"${config.theme}\". Use: ${Array.from(VALID_THEMES).join(', ')}`);\n  }\n  if (config.position && !VALID_POSITIONS.has(config.position)) {\n    throw new Error(`Invalid position \"${config.position}\". Use: ${Array.from(VALID_POSITIONS).join(', ')}`);\n  }\n  return true;\n}\n\nfunction mergeConfig(userConfig) {\n  validateConfig(userConfig);\n  return { ...DEFAULTS, ...userConfig };\n}\n\nmodule.exports = { DEFAULTS, validateConfig, mergeConfig };\n", "/**\n * All widget CSS as a JS string, injected into Shadow DOM.\n * Ported from public/demo/styles.css (trigger, panel, and generated UI sections).\n */\n\nfunction getStyles(theme) {\n  const isDark = theme !== 'light';\n\n  const vars = isDark ? `\n    --ncodes-bg-body: #050505;\n    --ncodes-bg-card: #0f0f0f;\n    --ncodes-bg-panel: #0d0d0d;\n    --ncodes-border-color: #262626;\n    --ncodes-border-light: #1a1a1a;\n    --ncodes-text-main: #ededed;\n    --ncodes-text-muted: #a1a1aa;\n    --ncodes-text-dim: #52525b;\n    --ncodes-accent: #4ade80;\n    --ncodes-accent-dim: rgba(74, 222, 128, 0.1);\n    --ncodes-accent-hover: #86efac;\n    --ncodes-danger: #f87171;\n    --ncodes-danger-dim: rgba(248, 113, 113, 0.1);\n    --ncodes-warning: #fbbf24;\n    --ncodes-warning-dim: rgba(251, 191, 36, 0.1);\n  ` : `\n    --ncodes-bg-body: #ffffff;\n    --ncodes-bg-card: #f9fafb;\n    --ncodes-bg-panel: #ffffff;\n    --ncodes-border-color: #e5e7eb;\n    --ncodes-border-light: #f3f4f6;\n    --ncodes-text-main: #111827;\n    --ncodes-text-muted: #6b7280;\n    --ncodes-text-dim: #9ca3af;\n    --ncodes-accent: #22c55e;\n    --ncodes-accent-dim: rgba(34, 197, 94, 0.1);\n    --ncodes-accent-hover: #16a34a;\n    --ncodes-danger: #ef4444;\n    --ncodes-danger-dim: rgba(239, 68, 68, 0.1);\n    --ncodes-warning: #f59e0b;\n    --ncodes-warning-dim: rgba(245, 158, 11, 0.1);\n  `;\n\n  return `\n    :host {\n      ${vars}\n      --ncodes-font: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      --ncodes-mono: 'SF Mono', SFMono-Regular, Consolas, 'Liberation Mono', Menlo, monospace;\n      all: initial;\n      font-family: var(--ncodes-font);\n      color: var(--ncodes-text-main);\n    }\n\n    *, *::before, *::after {\n      box-sizing: border-box;\n      margin: 0;\n      padding: 0;\n    }\n\n    /* ===== Trigger Button ===== */\n    .ncodes-trigger {\n      position: fixed;\n      bottom: 16px;\n      left: 50%;\n      transform: translateX(-50%);\n      height: 36px;\n      padding: 0 16px;\n      border-radius: 99px;\n      background: var(--ncodes-bg-card);\n      border: 1px solid var(--ncodes-border-color);\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      gap: 8px;\n      color: var(--ncodes-text-muted);\n      font-size: 13px;\n      font-weight: 500;\n      font-family: var(--ncodes-font);\n      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n      transition: all 0.2s ease;\n      z-index: 10000;\n      animation: ncodes-breathe 3s infinite ease-in-out;\n    }\n\n    .ncodes-trigger.bottom-right {\n      left: auto;\n      right: 16px;\n      transform: none;\n    }\n\n    .ncodes-trigger.bottom-left {\n      left: 16px;\n      transform: none;\n    }\n\n    @keyframes ncodes-breathe {\n      0% {\n        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n        border-color: var(--ncodes-border-color);\n      }\n      50% {\n        box-shadow: 0 0 25px var(--ncodes-accent-dim), 0 0 10px var(--ncodes-accent-dim);\n        border-color: var(--ncodes-accent);\n      }\n      100% {\n        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n        border-color: var(--ncodes-border-color);\n      }\n    }\n\n    .ncodes-trigger svg {\n      width: 16px;\n      height: 16px;\n      color: var(--ncodes-accent);\n    }\n\n    .ncodes-trigger:hover {\n      background: var(--ncodes-bg-panel);\n      border-color: var(--ncodes-accent);\n      color: var(--ncodes-text-main);\n      box-shadow: 0 6px 30px rgba(0, 0, 0, 0.4);\n    }\n\n    .ncodes-trigger:active {\n      transform: translateX(-50%) scale(0.98);\n    }\n\n    .ncodes-trigger.bottom-right:active,\n    .ncodes-trigger.bottom-left:active {\n      transform: scale(0.98);\n    }\n\n    .ncodes-trigger.hidden {\n      opacity: 0;\n      pointer-events: none;\n      transform: translateX(-50%) scale(0.9);\n    }\n\n    .ncodes-trigger.bottom-right.hidden {\n      transform: scale(0.9);\n    }\n\n    .ncodes-trigger.bottom-left.hidden {\n      transform: scale(0.9);\n    }\n\n    /* ===== Panel ===== */\n    @keyframes ncodes-glow-rotate {\n      from { --ncodes-glow-angle: 0deg; }\n      to { --ncodes-glow-angle: 360deg; }\n    }\n\n    @keyframes ncodes-glow-breathe {\n      0%, 100% {\n        box-shadow:\n          0 20px 60px rgba(0, 0, 0, 0.5),\n          0 0 20px rgba(74, 222, 128, 0.1),\n          0 0 40px rgba(74, 222, 128, 0.05);\n      }\n      50% {\n        box-shadow:\n          0 20px 60px rgba(0, 0, 0, 0.5),\n          0 0 40px rgba(74, 222, 128, 0.25),\n          0 0 80px rgba(74, 222, 128, 0.12),\n          0 0 120px rgba(74, 222, 128, 0.06);\n      }\n    }\n\n    .ncodes-panel {\n      position: fixed;\n      bottom: 64px;\n      left: 50%;\n      transform: translateX(-50%) scale(0.95);\n      width: 400px;\n      max-height: calc(100vh - 100px);\n      background: var(--ncodes-bg-panel);\n      border: 1px solid transparent;\n      border-radius: 16px;\n      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n      z-index: 10001;\n      display: flex;\n      flex-direction: column;\n      opacity: 0;\n      pointer-events: none;\n      transform-origin: bottom center;\n      transition: all 0.2s ease;\n    }\n\n    .ncodes-panel.open {\n      transform: translateX(-50%) scale(1);\n      opacity: 1;\n      pointer-events: auto;\n      --ncodes-glow-angle: 0deg;\n      animation:\n        ncodes-glow-rotate 4s linear infinite,\n        ncodes-glow-breathe 3s ease-in-out infinite;\n      background:\n        linear-gradient(var(--ncodes-bg-panel), var(--ncodes-bg-panel)) padding-box,\n        conic-gradient(\n          from var(--ncodes-glow-angle, 0deg),\n          var(--ncodes-accent),\n          rgba(74, 222, 128, 0.15),\n          rgba(56, 189, 248, 0.6),\n          rgba(139, 92, 246, 0.5),\n          var(--ncodes-accent),\n          rgba(74, 222, 128, 0.15),\n          var(--ncodes-accent)\n        ) border-box;\n      border: 1.5px solid transparent;\n    }\n\n    .ncodes-panel.bottom-right {\n      left: auto;\n      right: 16px;\n      transform: scale(0.95);\n      transform-origin: bottom right;\n    }\n\n    .ncodes-panel.bottom-left {\n      left: 16px;\n      transform: scale(0.95);\n      transform-origin: bottom left;\n    }\n\n    .ncodes-panel.bottom-right.open {\n      transform: scale(1);\n    }\n\n    .ncodes-panel.bottom-left.open {\n      transform: scale(1);\n    }\n\n    .panel-header {\n      padding: 16px 20px;\n      border-bottom: 1px solid var(--ncodes-border-color);\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n\n    .panel-title {\n      display: flex;\n      align-items: center;\n      gap: 10px;\n      font-weight: 600;\n      font-size: 15px;\n    }\n\n    .panel-logo {\n      width: 28px;\n      height: 28px;\n      background: var(--ncodes-accent);\n      border-radius: 6px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-weight: 700;\n      color: #000;\n      font-size: 16px;\n      font-family: var(--ncodes-mono);\n    }\n\n    .panel-close {\n      width: 28px;\n      height: 28px;\n      border: none;\n      background: transparent;\n      color: var(--ncodes-text-dim);\n      font-size: 20px;\n      cursor: pointer;\n      border-radius: 6px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: all 0.15s ease;\n      font-family: var(--ncodes-font);\n    }\n\n    .panel-close:hover {\n      background: var(--ncodes-bg-card);\n      color: var(--ncodes-text-main);\n    }\n\n    .panel-body {\n      padding: 20px;\n      overflow-y: auto;\n    }\n\n    .panel-intro {\n      margin-bottom: 20px;\n    }\n\n    .panel-intro p {\n      color: var(--ncodes-text-muted);\n      font-size: 14px;\n      line-height: 1.5;\n    }\n\n    /* ===== Prompt Section ===== */\n    .prompt-section {\n      margin-bottom: 24px;\n    }\n\n    .prompt-input {\n      width: 100%;\n      background: var(--ncodes-bg-body);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 10px;\n      padding: 14px 16px;\n      color: var(--ncodes-text-main);\n      font-size: 14px;\n      font-family: var(--ncodes-font);\n      resize: none;\n      margin-bottom: 12px;\n      transition: border-color 0.15s ease;\n    }\n\n    .prompt-input:focus {\n      outline: none;\n      border-color: var(--ncodes-accent);\n    }\n\n    .prompt-input::placeholder {\n      color: var(--ncodes-text-dim);\n    }\n\n    .generate-btn {\n      width: 100%;\n      padding: 12px 20px;\n      background: var(--ncodes-accent);\n      border: none;\n      border-radius: 10px;\n      color: #000;\n      font-size: 14px;\n      font-weight: 600;\n      cursor: pointer;\n      transition: all 0.15s ease;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      gap: 8px;\n      font-family: var(--ncodes-font);\n    }\n\n    .generate-btn:hover {\n      background: var(--ncodes-accent-hover);\n    }\n\n    .generate-btn:disabled {\n      opacity: 0.6;\n      cursor: not-allowed;\n    }\n\n    .btn-loading {\n      display: flex;\n      gap: 4px;\n    }\n\n    .loading-dot {\n      width: 6px;\n      height: 6px;\n      background: #000;\n      border-radius: 50%;\n      animation: ncodes-bounce 1.4s infinite ease-in-out both;\n    }\n\n    .loading-dot:nth-child(1) { animation-delay: -0.32s; }\n    .loading-dot:nth-child(2) { animation-delay: -0.16s; }\n\n    @keyframes ncodes-bounce {\n      0%, 80%, 100% { transform: scale(0); }\n      40% { transform: scale(1); }\n    }\n\n    /* ===== Quick Prompts ===== */\n    .quick-prompts {\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n    }\n\n    .quick-prompts-label {\n      font-size: 12px;\n      color: var(--ncodes-text-dim);\n      text-transform: uppercase;\n      letter-spacing: 0.05em;\n      font-weight: 500;\n      margin-bottom: 4px;\n    }\n\n    .quick-prompt {\n      padding: 10px 14px;\n      background: var(--ncodes-bg-body);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 8px;\n      color: var(--ncodes-text-muted);\n      font-size: 13px;\n      text-align: left;\n      cursor: pointer;\n      transition: all 0.15s ease;\n      font-family: var(--ncodes-font);\n    }\n\n    .quick-prompt:hover {\n      border-color: var(--ncodes-accent);\n      color: var(--ncodes-text-main);\n      background: var(--ncodes-accent-dim);\n    }\n\n    /* ===== Generation Status ===== */\n    .generation-status {\n      margin-top: 20px;\n      padding: 16px;\n      background: var(--ncodes-bg-body);\n      border-radius: 10px;\n      border: 1px solid var(--ncodes-border-color);\n    }\n\n    .status-line {\n      display: flex;\n      align-items: center;\n      gap: 10px;\n      color: var(--ncodes-text-muted);\n      font-size: 13px;\n    }\n\n    .status-icon {\n      font-size: 16px;\n    }\n\n    .status-icon.spinning {\n      animation: ncodes-spin 1s linear infinite;\n    }\n\n    @keyframes ncodes-spin {\n      from { transform: rotate(0deg); }\n      to { transform: rotate(360deg); }\n    }\n\n    .status-step {\n      display: inline-block;\n      font-size: 11px;\n      color: var(--ncodes-text-dim);\n      font-family: var(--ncodes-mono);\n      text-transform: uppercase;\n      letter-spacing: 0.05em;\n      margin-left: 26px;\n      margin-top: 6px;\n    }\n\n    .status-step:empty {\n      display: none;\n    }\n\n    .status-step::after {\n      content: '';\n      animation: ncodes-dots 1.4s steps(4, end) infinite;\n    }\n\n    @keyframes ncodes-dots {\n      0% { content: ''; }\n      25% { content: '.'; }\n      50% { content: '..'; }\n      75% { content: '...'; }\n    }\n\n    /* ===== Panel Expansion (result view) \u2014 centered dialog ===== */\n    .ncodes-panel.expanded {\n      width: 80vw;\n      height: 80vh;\n      max-width: 1200px;\n      max-height: 80vh;\n      top: 50%;\n      left: 50% !important;\n      right: auto !important;\n      bottom: auto;\n      transform: translate(-50%, -50%) !important;\n      transform-origin: center center;\n      border-radius: 16px;\n    }\n\n    /* ===== View Toggling ===== */\n    .result-view {\n      display: none;\n    }\n\n    .ncodes-panel.expanded .prompt-view {\n      display: none;\n    }\n\n    .ncodes-panel.expanded .result-view {\n      display: flex;\n      flex-direction: column;\n      flex: 1;\n      min-height: 0;\n    }\n\n    .ncodes-panel.expanded .panel-body {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      min-height: 0;\n    }\n\n    /* ===== History Section ===== */\n    .history-section {\n      margin-bottom: 20px;\n    }\n\n    .history-label {\n      font-size: 12px;\n      color: var(--ncodes-text-dim);\n      text-transform: uppercase;\n      letter-spacing: 0.05em;\n      font-weight: 500;\n      margin-bottom: 8px;\n    }\n\n    .history-list {\n      display: flex;\n      flex-direction: column;\n      gap: 6px;\n    }\n\n    .history-item {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 10px 12px;\n      background: var(--ncodes-bg-body);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 8px;\n      cursor: pointer;\n      transition: all 0.15s ease;\n      font-family: var(--ncodes-font);\n    }\n\n    .history-item:hover {\n      border-color: var(--ncodes-accent);\n      background: var(--ncodes-accent-dim);\n    }\n\n    .history-prompt-text {\n      flex: 1;\n      font-size: 13px;\n      color: var(--ncodes-text-muted);\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n\n    .history-item:hover .history-prompt-text {\n      color: var(--ncodes-text-main);\n    }\n\n    .history-delete {\n      width: 22px;\n      height: 22px;\n      border: none;\n      background: transparent;\n      color: var(--ncodes-text-dim);\n      font-size: 14px;\n      cursor: pointer;\n      border-radius: 4px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: all 0.15s ease;\n      flex-shrink: 0;\n      font-family: var(--ncodes-font);\n    }\n\n    .history-delete:hover {\n      background: var(--ncodes-danger-dim);\n      color: var(--ncodes-danger);\n    }\n\n    /* ===== Result View ===== */\n    .result-header {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      margin-bottom: 16px;\n      padding-bottom: 12px;\n      border-bottom: 1px solid var(--ncodes-border-color);\n    }\n\n    .result-back-btn {\n      padding: 6px 12px;\n      border: 1px solid var(--ncodes-border-color);\n      background: var(--ncodes-bg-body);\n      color: var(--ncodes-text-muted);\n      font-size: 13px;\n      font-weight: 500;\n      cursor: pointer;\n      border-radius: 6px;\n      transition: all 0.15s ease;\n      font-family: var(--ncodes-font);\n      flex-shrink: 0;\n    }\n\n    .result-back-btn:hover {\n      background: var(--ncodes-bg-card);\n      color: var(--ncodes-text-main);\n    }\n\n    .result-prompt-label {\n      font-size: 13px;\n      color: var(--ncodes-text-dim);\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n\n    .result-content {\n      overflow-y: auto;\n      flex: 1;\n      background: var(--ncodes-bg-card);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 12px;\n    }\n\n    /* ===== Generated UI (inline) ===== */\n\n    .generated-header {\n      padding: 20px 24px;\n      border-bottom: 1px solid var(--ncodes-border-color);\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n\n    .generated-title {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n    }\n\n    .generated-title h2 {\n      font-size: 18px;\n      font-weight: 600;\n      color: var(--ncodes-text-main);\n    }\n\n    .generated-badge {\n      font-size: 11px;\n      padding: 4px 10px;\n      background: var(--ncodes-accent-dim);\n      color: var(--ncodes-accent);\n      border-radius: 99px;\n      font-family: var(--ncodes-mono);\n      font-weight: 500;\n    }\n\n    .close-btn {\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      padding: 8px 14px;\n      border-radius: 8px;\n      font-size: 13px;\n      font-weight: 500;\n      cursor: pointer;\n      border: 1px solid var(--ncodes-border-color);\n      background: var(--ncodes-bg-body);\n      color: var(--ncodes-text-muted);\n      transition: all 0.15s ease;\n      font-family: var(--ncodes-font);\n    }\n\n    .close-btn:hover {\n      background: var(--ncodes-bg-card);\n      color: var(--ncodes-text-main);\n    }\n\n    .generated-body {\n      padding: 24px;\n    }\n\n    /* ===== Data Table (for generated UIs) ===== */\n    .data-table {\n      width: 100%;\n      border-collapse: collapse;\n      font-size: 14px;\n    }\n\n    .data-table th {\n      text-align: left;\n      color: var(--ncodes-text-dim);\n      font-weight: 500;\n      padding: 12px 16px;\n      font-size: 12px;\n      text-transform: uppercase;\n      letter-spacing: 0.05em;\n      border-bottom: 1px solid var(--ncodes-border-color);\n    }\n\n    .data-table td {\n      padding: 16px;\n      color: var(--ncodes-text-muted);\n      border-bottom: 1px solid var(--ncodes-border-light);\n      vertical-align: middle;\n    }\n\n    .data-table tbody tr:last-child td {\n      border-bottom: none;\n    }\n\n    .customer-cell {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n    }\n\n    .avatar {\n      width: 36px;\n      height: 36px;\n      background: var(--ncodes-bg-body);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 8px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 12px;\n      font-weight: 600;\n      color: var(--ncodes-text-muted);\n      flex-shrink: 0;\n    }\n\n    .customer-name {\n      font-weight: 500;\n      color: var(--ncodes-text-main);\n      margin-bottom: 2px;\n    }\n\n    .customer-email {\n      font-size: 12px;\n      color: var(--ncodes-text-dim);\n    }\n\n    .mono {\n      font-family: var(--ncodes-mono);\n      font-size: 13px;\n    }\n\n    .amount {\n      font-family: var(--ncodes-mono);\n      color: var(--ncodes-text-main);\n      font-weight: 500;\n    }\n\n    .overdue-badge {\n      display: inline-block;\n      padding: 4px 10px;\n      border-radius: 6px;\n      font-size: 12px;\n      font-weight: 500;\n    }\n\n    .overdue-badge.mild {\n      background: var(--ncodes-warning-dim);\n      color: var(--ncodes-warning);\n    }\n\n    .overdue-badge.moderate {\n      background: rgba(251, 146, 60, 0.1);\n      color: #fb923c;\n    }\n\n    .overdue-badge.severe {\n      background: var(--ncodes-danger-dim);\n      color: var(--ncodes-danger);\n    }\n\n    .action-btn {\n      padding: 8px 14px;\n      border-radius: 6px;\n      font-size: 13px;\n      font-weight: 500;\n      cursor: pointer;\n      border: none;\n      transition: all 0.15s ease;\n      font-family: var(--ncodes-font);\n    }\n\n    .action-btn.remind {\n      background: var(--ncodes-accent-dim);\n      color: var(--ncodes-accent);\n    }\n\n    .action-btn.remind:hover {\n      background: var(--ncodes-accent);\n      color: #000;\n    }\n\n    .action-btn.primary {\n      background: var(--ncodes-accent);\n      color: #000;\n    }\n\n    .action-btn.primary:hover {\n      background: var(--ncodes-accent-hover);\n    }\n\n    .action-btn.secondary {\n      background: var(--ncodes-bg-body);\n      border: 1px solid var(--ncodes-border-color);\n      color: var(--ncodes-text-muted);\n    }\n\n    .action-btn.secondary:hover {\n      color: var(--ncodes-text-main);\n    }\n\n    .action-btn.danger {\n      background: var(--ncodes-danger);\n      color: #fff;\n    }\n\n    .table-footer {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding-top: 20px;\n      margin-top: 8px;\n      border-top: 1px solid var(--ncodes-border-color);\n    }\n\n    .table-info {\n      font-size: 13px;\n      color: var(--ncodes-text-dim);\n    }\n\n    /* ===== Health Dashboard Styles ===== */\n    .health-stats {\n      display: grid;\n      grid-template-columns: repeat(3, 1fr);\n      gap: 16px;\n      margin-bottom: 24px;\n    }\n\n    .health-stat {\n      background: var(--ncodes-bg-body);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 12px;\n      padding: 20px;\n    }\n\n    .health-stat-value {\n      font-size: 32px;\n      font-weight: 600;\n      margin-bottom: 4px;\n    }\n\n    .health-stat.healthy .health-stat-value { color: var(--ncodes-accent); }\n    .health-stat.at-risk .health-stat-value { color: var(--ncodes-warning); }\n    .health-stat.churning .health-stat-value { color: var(--ncodes-danger); }\n\n    .health-stat-label {\n      font-size: 13px;\n      color: var(--ncodes-text-muted);\n      margin-bottom: 12px;\n    }\n\n    .health-bar {\n      height: 4px;\n      background: var(--ncodes-border-color);\n      border-radius: 2px;\n      overflow: hidden;\n    }\n\n    .health-bar-fill {\n      height: 100%;\n      border-radius: 2px;\n    }\n\n    .health-stat.healthy .health-bar-fill { background: var(--ncodes-accent); }\n    .health-stat.at-risk .health-bar-fill { background: var(--ncodes-warning); }\n    .health-stat.churning .health-bar-fill { background: var(--ncodes-danger); }\n\n    .dashboard-grid {\n      display: grid;\n      grid-template-columns: repeat(2, 1fr);\n      gap: 20px;\n      margin-bottom: 24px;\n    }\n\n    .dashboard-card {\n      background: var(--ncodes-bg-body);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 12px;\n      padding: 20px;\n    }\n\n    .dashboard-card h3 {\n      font-size: 14px;\n      font-weight: 600;\n      color: var(--ncodes-text-main);\n      margin-bottom: 16px;\n    }\n\n    .risk-list {\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n    }\n\n    .risk-item {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n\n    .risk-customer {\n      display: flex;\n      align-items: center;\n      gap: 10px;\n      font-size: 13px;\n      color: var(--ncodes-text-muted);\n    }\n\n    .risk-score {\n      font-family: var(--ncodes-mono);\n      font-size: 13px;\n      font-weight: 500;\n      padding: 4px 8px;\n      border-radius: 4px;\n    }\n\n    .risk-score.high {\n      background: var(--ncodes-danger-dim);\n      color: var(--ncodes-danger);\n    }\n\n    .risk-score.medium {\n      background: var(--ncodes-warning-dim);\n      color: var(--ncodes-warning);\n    }\n\n    .avatar.small {\n      width: 28px;\n      height: 28px;\n      font-size: 10px;\n    }\n\n    .mini-chart {\n      display: flex;\n      align-items: flex-end;\n      gap: 8px;\n      height: 80px;\n      margin-bottom: 8px;\n    }\n\n    .chart-bar {\n      flex: 1;\n      background: linear-gradient(to top, var(--ncodes-accent), rgba(74, 222, 128, 0.3));\n      border-radius: 4px 4px 0 0;\n      min-height: 10px;\n    }\n\n    .chart-labels {\n      display: flex;\n      justify-content: space-between;\n      font-size: 10px;\n      color: var(--ncodes-text-dim);\n    }\n\n    .dashboard-actions {\n      display: flex;\n      gap: 12px;\n      justify-content: flex-end;\n    }\n\n    /* ===== Archive Styles ===== */\n    .archive-info {\n      background: var(--ncodes-bg-body);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 12px;\n      padding: 24px;\n      text-align: center;\n      margin-bottom: 20px;\n    }\n\n    .archive-stat-value {\n      font-size: 48px;\n      font-weight: 600;\n      color: var(--ncodes-warning);\n      display: block;\n    }\n\n    .archive-stat-label {\n      font-size: 14px;\n      color: var(--ncodes-text-muted);\n    }\n\n    .selection-header {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 12px 16px;\n      background: var(--ncodes-bg-body);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 8px 8px 0 0;\n      border-bottom: none;\n    }\n\n    .checkbox-label {\n      display: flex;\n      align-items: center;\n      gap: 10px;\n      font-size: 13px;\n      color: var(--ncodes-text-muted);\n      cursor: pointer;\n    }\n\n    .checkbox-label input[type=\"checkbox\"] {\n      width: 16px;\n      height: 16px;\n      accent-color: var(--ncodes-accent);\n    }\n\n    .selection-count {\n      font-size: 12px;\n      color: var(--ncodes-text-dim);\n    }\n\n    .data-table.selectable {\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 0 0 8px 8px;\n    }\n\n    .row-checkbox {\n      width: 16px;\n      height: 16px;\n      accent-color: var(--ncodes-accent);\n    }\n\n    .muted {\n      color: var(--ncodes-text-dim);\n    }\n\n    .type-badge {\n      display: inline-block;\n      padding: 4px 10px;\n      background: var(--ncodes-bg-card);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 6px;\n      font-size: 11px;\n      font-weight: 500;\n      color: var(--ncodes-text-muted);\n    }\n\n    .status-badge {\n      display: inline-block;\n      padding: 4px 10px;\n      border-radius: 6px;\n      font-size: 11px;\n      font-weight: 500;\n    }\n\n    .status-badge.inactive {\n      background: var(--ncodes-border-color);\n      color: var(--ncodes-text-dim);\n    }\n\n    .archive-actions {\n      display: flex;\n      gap: 12px;\n    }\n\n    /* ===== Responsive ===== */\n    @media (max-width: 768px) {\n      .ncodes-panel {\n        width: calc(100% - 32px);\n        left: 16px !important;\n        right: 16px;\n        transform: scale(0.95) !important;\n      }\n\n      .ncodes-panel.open {\n        transform: scale(1) !important;\n      }\n\n      .ncodes-panel.expanded {\n        width: 95vw;\n        height: 90vh;\n        max-height: 90vh;\n      }\n\n      .health-stats {\n        grid-template-columns: 1fr;\n      }\n\n      .dashboard-grid {\n        grid-template-columns: 1fr;\n      }\n    }\n\n    /* ===== Error State ===== */\n    .ncodes-error-state {\n      text-align: center;\n      padding: 32px 20px;\n    }\n\n    .ncodes-error-icon {\n      font-size: 32px;\n      margin-bottom: 12px;\n    }\n\n    .ncodes-error-message {\n      font-size: 14px;\n      color: var(--ncodes-text-muted);\n      line-height: 1.5;\n      margin-bottom: 20px;\n      max-width: 320px;\n      margin-left: auto;\n      margin-right: auto;\n    }\n\n    .ncodes-error-actions {\n      display: flex;\n      gap: 10px;\n      justify-content: center;\n    }\n\n    .ncodes-error-retry {\n      padding: 8px 18px;\n      background: var(--ncodes-accent);\n      border: none;\n      border-radius: 8px;\n      color: #000;\n      font-size: 13px;\n      font-weight: 600;\n      cursor: pointer;\n      font-family: var(--ncodes-font);\n      transition: background 0.15s ease;\n    }\n\n    .ncodes-error-retry:hover {\n      background: var(--ncodes-accent-hover);\n    }\n\n    .ncodes-error-fallback {\n      padding: 8px 18px;\n      background: transparent;\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 8px;\n      color: var(--ncodes-text-muted);\n      font-size: 13px;\n      font-weight: 500;\n      cursor: pointer;\n      font-family: var(--ncodes-font);\n      transition: border-color 0.15s ease;\n    }\n\n    .ncodes-error-fallback:hover {\n      border-color: var(--ncodes-text-muted);\n    }\n\n    /* ===== Clarifying Question ===== */\n    .ncodes-clarifying-question {\n      padding: 32px 20px;\n      text-align: center;\n    }\n\n    .ncodes-clarifying-text {\n      font-size: 15px;\n      color: var(--ncodes-text-main);\n      line-height: 1.5;\n      margin-bottom: 20px;\n      max-width: 400px;\n      margin-left: auto;\n      margin-right: auto;\n    }\n\n    .ncodes-clarifying-options {\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n      max-width: 320px;\n      margin: 0 auto;\n    }\n\n    .ncodes-clarifying-option {\n      padding: 10px 16px;\n      background: var(--ncodes-bg-body);\n      border: 1px solid var(--ncodes-border-color);\n      border-radius: 8px;\n      color: var(--ncodes-text-muted);\n      font-size: 13px;\n      font-weight: 500;\n      cursor: pointer;\n      transition: all 0.15s ease;\n      font-family: var(--ncodes-font);\n    }\n\n    .ncodes-clarifying-option:hover {\n      border-color: var(--ncodes-accent);\n      color: var(--ncodes-text-main);\n      background: var(--ncodes-accent-dim);\n    }\n\n    /* ===== Sandbox iframe ===== */\n    .result-content iframe {\n      width: 100%;\n      height: 100%;\n      min-height: 400px;\n    }\n  `;\n}\n\nmodule.exports = { getStyles };\n", "/**\n * Floating \"Build with AI\" trigger button.\n */\n\nfunction createTriggerIcon() {\n  const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  svg.setAttribute('width', '18');\n  svg.setAttribute('height', '18');\n  svg.setAttribute('viewBox', '0 0 24 24');\n  svg.setAttribute('fill', 'none');\n  svg.setAttribute('stroke', 'currentColor');\n  svg.setAttribute('stroke-width', '2.5');\n\n  const path1 = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n  path1.setAttribute('d', 'M7 4h-3v16h3');\n  path1.setAttribute('stroke-linecap', 'round');\n  path1.setAttribute('stroke-linejoin', 'round');\n\n  const path2 = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n  path2.setAttribute('d', 'M17 4h3v16h-3');\n  path2.setAttribute('stroke-linecap', 'round');\n  path2.setAttribute('stroke-linejoin', 'round');\n\n  svg.appendChild(path1);\n  svg.appendChild(path2);\n  return svg;\n}\n\nfunction createTrigger(config, onClickHandler) {\n  const btn = document.createElement('button');\n  btn.className = `ncodes-trigger ${config.position}`;\n  btn.title = 'Open n.codes';\n\n  btn.appendChild(createTriggerIcon());\n\n  const label = document.createElement('span');\n  label.textContent = config.triggerLabel;\n  btn.appendChild(label);\n\n  btn.addEventListener('click', onClickHandler);\n  return btn;\n}\n\nfunction showTrigger(trigger) {\n  trigger.classList.remove('hidden');\n}\n\nfunction hideTrigger(trigger) {\n  trigger.classList.add('hidden');\n}\n\nmodule.exports = { createTrigger, showTrigger, hideTrigger };\n", "/**\n * Slide-up prompt panel.\n * Built using safe DOM methods \u2014 no innerHTML with untrusted content.\n *\n * Two views:\n *   prompt-view (default) \u2014 intro, history, textarea, generate, quick prompts, status\n *   result-view (after generation / history click) \u2014 back button + generated UI\n */\n\nfunction createPanel(config) {\n  const panel = document.createElement('div');\n  panel.className = `ncodes-panel ${config.position}`;\n\n  // Header\n  const header = document.createElement('div');\n  header.className = 'panel-header';\n\n  const title = document.createElement('div');\n  title.className = 'panel-title';\n  const logo = document.createElement('span');\n  logo.className = 'panel-logo';\n  logo.textContent = 'n';\n  const titleText = document.createElement('span');\n  titleText.textContent = config.panelTitle;\n  title.appendChild(logo);\n  title.appendChild(titleText);\n\n  const closeBtn = document.createElement('button');\n  closeBtn.className = 'panel-close';\n  closeBtn.setAttribute('data-ncodes-panel-close', '');\n  closeBtn.textContent = '\\u00D7';\n\n  header.appendChild(title);\n\n  header.appendChild(closeBtn);\n\n  // Body\n  const body = document.createElement('div');\n  body.className = 'panel-body';\n\n  // === Prompt View ===\n  const promptView = document.createElement('div');\n  promptView.className = 'prompt-view';\n\n  const intro = document.createElement('div');\n  intro.className = 'panel-intro';\n  const introP = document.createElement('p');\n  introP.textContent = config.panelIntro;\n  intro.appendChild(introP);\n\n  // History section (populated dynamically)\n  const historySection = document.createElement('div');\n  historySection.className = 'history-section';\n  historySection.style.display = 'none';\n  const historyLabel = document.createElement('div');\n  historyLabel.className = 'history-label';\n  historyLabel.textContent = 'Recent features';\n  const historyList = document.createElement('div');\n  historyList.className = 'history-list';\n  historySection.appendChild(historyLabel);\n  historySection.appendChild(historyList);\n\n  const promptSection = document.createElement('div');\n  promptSection.className = 'prompt-section';\n\n  const textarea = document.createElement('textarea');\n  textarea.className = 'prompt-input';\n  textarea.placeholder = 'e.g., Show me overdue invoices with a remind button...';\n  textarea.rows = 3;\n\n  const generateBtn = document.createElement('button');\n  generateBtn.className = 'generate-btn';\n  const btnText = document.createElement('span');\n  btnText.className = 'btn-text';\n  btnText.textContent = 'Generate';\n  const btnLoading = document.createElement('span');\n  btnLoading.className = 'btn-loading';\n  btnLoading.style.display = 'none';\n  for (let i = 0; i < 3; i++) {\n    const dot = document.createElement('span');\n    dot.className = 'loading-dot';\n    btnLoading.appendChild(dot);\n  }\n  generateBtn.appendChild(btnText);\n  generateBtn.appendChild(btnLoading);\n\n  promptSection.appendChild(textarea);\n  promptSection.appendChild(generateBtn);\n\n  promptView.appendChild(intro);\n  promptView.appendChild(historySection);\n  promptView.appendChild(promptSection);\n\n  // Quick prompts\n  if (config.quickPrompts.length > 0) {\n    const quickSection = document.createElement('div');\n    quickSection.className = 'quick-prompts';\n    const quickLabel = document.createElement('div');\n    quickLabel.className = 'quick-prompts-label';\n    quickLabel.textContent = 'Try these examples:';\n    quickSection.appendChild(quickLabel);\n\n    config.quickPrompts.forEach((qp) => {\n      const btn = document.createElement('button');\n      btn.className = 'quick-prompt';\n      btn.setAttribute('data-prompt', qp.prompt);\n      btn.textContent = qp.label;\n      quickSection.appendChild(btn);\n    });\n\n    promptView.appendChild(quickSection);\n  }\n\n  // Generation status\n  const status = document.createElement('div');\n  status.className = 'generation-status';\n  status.style.display = 'none';\n  const statusLine = document.createElement('div');\n  statusLine.className = 'status-line';\n  const statusIcon = document.createElement('span');\n  statusIcon.className = 'status-icon spinning';\n  statusIcon.textContent = '\\u2699';\n  const statusText = document.createElement('span');\n  statusText.className = 'status-text';\n  statusText.textContent = 'Analyzing request...';\n  statusLine.appendChild(statusIcon);\n  statusLine.appendChild(statusText);\n  status.appendChild(statusLine);\n  const statusStep = document.createElement('div');\n  statusStep.className = 'status-step';\n  status.appendChild(statusStep);\n  promptView.appendChild(status);\n\n  // === Result View ===\n  const resultView = document.createElement('div');\n  resultView.className = 'result-view';\n\n  const resultHeader = document.createElement('div');\n  resultHeader.className = 'result-header';\n  const backBtn = document.createElement('button');\n  backBtn.className = 'result-back-btn';\n  backBtn.setAttribute('data-ncodes-back', '');\n  backBtn.textContent = '\\u2190 Back';\n  const resultPromptLabel = document.createElement('span');\n  resultPromptLabel.className = 'result-prompt-label';\n  resultHeader.appendChild(backBtn);\n  resultHeader.appendChild(resultPromptLabel);\n\n  const resultContent = document.createElement('div');\n  resultContent.className = 'result-content';\n\n  resultView.appendChild(resultHeader);\n  resultView.appendChild(resultContent);\n\n  body.appendChild(promptView);\n  body.appendChild(resultView);\n\n  panel.appendChild(header);\n  panel.appendChild(body);\n\n  return panel;\n}\n\nfunction openPanel(panel, trigger) {\n  panel.classList.add('open');\n  if (trigger) trigger.classList.add('hidden');\n  const input = panel.querySelector('.prompt-input');\n  if (input) input.focus();\n}\n\nfunction closePanel(panel, trigger) {\n  panel.classList.remove('open');\n  if (trigger) trigger.classList.remove('hidden');\n  showPromptView(panel);\n  resetPanelState(panel);\n}\n\nfunction resetPanelState(panel) {\n  const status = panel.querySelector('.generation-status');\n  const generateBtn = panel.querySelector('.generate-btn');\n  if (status) status.style.display = 'none';\n  if (generateBtn) {\n    generateBtn.disabled = false;\n    const btnText = generateBtn.querySelector('.btn-text');\n    const btnLoading = generateBtn.querySelector('.btn-loading');\n    if (btnText) btnText.style.display = 'inline';\n    if (btnLoading) btnLoading.style.display = 'none';\n  }\n}\n\n/**\n * Remove all child nodes from an element (safe alternative to innerHTML = '').\n */\nfunction clearChildren(el) {\n  while (el.firstChild) {\n    el.removeChild(el.firstChild);\n  }\n}\n\nfunction showResultView(panel, promptText) {\n  panel.classList.add('expanded');\n  const label = panel.querySelector('.result-prompt-label');\n  if (label) label.textContent = promptText || '';\n}\n\nfunction showPromptView(panel) {\n  panel.classList.remove('expanded');\n  const resultContent = panel.querySelector('.result-content');\n  if (resultContent) clearChildren(resultContent);\n}\n\nfunction getResultContainer(panel) {\n  return panel.querySelector('.result-content');\n}\n\n/**\n * Rebuild history list DOM from array.\n * Each item: clickable row with prompt text and delete button.\n */\nfunction updateHistoryList(panel, history) {\n  const section = panel.querySelector('.history-section');\n  const list = panel.querySelector('.history-list');\n  if (!section || !list) return;\n\n  // Clear existing items\n  clearChildren(list);\n\n  if (history.length === 0) {\n    section.style.display = 'none';\n    return;\n  }\n\n  section.style.display = 'block';\n\n  history.forEach((item) => {\n    const row = document.createElement('div');\n    row.className = 'history-item';\n    row.setAttribute('data-history-id', item.id);\n\n    const text = document.createElement('span');\n    text.className = 'history-prompt-text';\n    text.textContent = item.prompt;\n\n    const deleteBtn = document.createElement('button');\n    deleteBtn.className = 'history-delete';\n    deleteBtn.setAttribute('data-history-delete', item.id);\n    deleteBtn.textContent = '\\u00D7';\n\n    row.appendChild(text);\n    row.appendChild(deleteBtn);\n    list.appendChild(row);\n  });\n}\n\n/**\n * Replace quick-prompt buttons in the panel.\n * Creates the quick-prompts section if it doesn't exist.\n * @param {HTMLElement} panel\n * @param {Array<{label: string, prompt: string}>} prompts\n */\nfunction updateQuickPrompts(panel, prompts) {\n  const promptView = panel.querySelector('.prompt-view');\n  if (!promptView) return;\n\n  // Remove existing quick-prompts section\n  const existing = promptView.querySelector('.quick-prompts');\n  if (existing) existing.remove();\n\n  if (!prompts || prompts.length === 0) return;\n\n  const quickSection = document.createElement('div');\n  quickSection.className = 'quick-prompts';\n  const quickLabel = document.createElement('div');\n  quickLabel.className = 'quick-prompts-label';\n  quickLabel.textContent = 'Try these examples:';\n  quickSection.appendChild(quickLabel);\n\n  prompts.forEach((qp) => {\n    const btn = document.createElement('button');\n    btn.className = 'quick-prompt';\n    btn.setAttribute('data-prompt', qp.prompt);\n    btn.textContent = qp.label;\n    quickSection.appendChild(btn);\n  });\n\n  // Insert before generation-status (last child of promptView)\n  const status = promptView.querySelector('.generation-status');\n  if (status) {\n    promptView.insertBefore(quickSection, status);\n  } else {\n    promptView.appendChild(quickSection);\n  }\n}\n\nmodule.exports = {\n  createPanel,\n  openPanel,\n  closePanel,\n  resetPanelState,\n  showResultView,\n  showPromptView,\n  getResultContainer,\n  updateHistoryList,\n  updateQuickPrompts,\n};\n", "'use strict';\n\n/**\n * API bridge script injected into the sandboxed iframe.\n * Provides window.ncodes.query() and window.ncodes.action()\n * which communicate with the parent window via postMessage.\n *\n * This is a string template (not a module) because it gets\n * injected as an inline <script> inside the iframe srcdoc.\n */\n\n/**\n * Generate the bridge script string to inject into iframe srcdoc.\n *\n * @param {object} [appInfo] - App info from capability map\n * @param {string} [appInfo.name] - App name\n * @param {string[]} [appInfo.entities] - Available entity names\n * @returns {string} JavaScript source code as a string\n */\nfunction getBridgeScript(appInfo) {\n  const appJSON = JSON.stringify(appInfo || { name: '', entities: [] });\n\n  return `\n(function() {\n  'use strict';\n\n  var REQUEST_TIMEOUT = 30000;\n  var _requestId = 0;\n  var _pending = {};\n\n  function generateId() {\n    return 'ncodes-req-' + (++_requestId) + '-' + Date.now();\n  }\n\n  function sendRequest(method, ref, payload) {\n    return new Promise(function(resolve, reject) {\n      var id = generateId();\n      console.log('[n.codes:bridge] request', method, ref, payload);\n\n      var timeoutHandle = setTimeout(function() {\n        delete _pending[id];\n        console.warn('[n.codes:bridge] timeout', id, ref);\n        reject(new Error('API request timed out after ' + REQUEST_TIMEOUT + 'ms'));\n      }, REQUEST_TIMEOUT);\n\n      _pending[id] = { resolve: resolve, reject: reject, timeout: timeoutHandle };\n\n      // targetOrigin '*' is required: this iframe has an opaque origin\n      // (sandbox without allow-same-origin), so no specific origin to target.\n      window.parent.postMessage({\n        type: 'ncodes:api-request',\n        id: id,\n        method: method,\n        ref: ref,\n        params: method === 'query' ? payload : undefined,\n        data: method === 'action' ? payload : undefined\n      }, '*');\n    });\n  }\n\n  window.addEventListener('message', function(event) {\n    if (!event.data || event.data.type !== 'ncodes:api-response') return;\n\n    var id = event.data.id;\n    var handler = _pending[id];\n    if (!handler) return;\n\n    clearTimeout(handler.timeout);\n    delete _pending[id];\n\n    console.log('[n.codes:bridge] response', id, event.data.error ? 'ERROR' : 'OK', event.data.data);\n\n    if (event.data.error) {\n      handler.reject(new Error(event.data.error));\n    } else {\n      handler.resolve(event.data.data);\n    }\n  });\n\n  window.addEventListener('error', function(event) {\n    console.error('[n.codes:bridge] JS error:', event.message, 'at', event.filename, ':', event.lineno);\n    // targetOrigin '*' required \u2014 see note above about opaque origins.\n    window.parent.postMessage({\n      type: 'ncodes:sandbox-error',\n      message: event.message,\n      lineno: event.lineno,\n      colno: event.colno\n    }, '*');\n  });\n\n  window.ncodes = {\n    query: function(ref, params) {\n      return sendRequest('query', ref, params || {});\n    },\n    action: function(ref, data) {\n      return sendRequest('action', ref, data || {});\n    },\n    app: ${appJSON}\n  };\n})();\n`;\n}\n\nmodule.exports = { getBridgeScript };\n", "'use strict';\n\n/**\n * Message handler \u2014 runs in the parent window.\n * Listens for postMessage from the sandboxed iframe,\n * validates refs against the apiBindings whitelist,\n * proxies fetch calls to the host app, and returns results.\n */\n\n/**\n * Create a message handler for a specific iframe.\n *\n * @param {HTMLIFrameElement} iframe - The sandboxed iframe element\n * @param {Array} apiBindings - Whitelist of allowed API bindings\n *   Each: { type: 'query'|'action', ref: string, resolved: { method, path } }\n * @param {object} [options]\n * @param {function} [options.fetchFn] - Custom fetch (for testing)\n * @returns {{ start(), stop(), handler(event) }}\n */\nfunction createMessageHandler(iframe, apiBindings, options) {\n  const opts = options || {};\n  const doFetch = opts.fetchFn || globalThis.fetch;\n\n  // Build a lookup map: ref -> { type, method, path }\n  const bindingsMap = {};\n  if (Array.isArray(apiBindings)) {\n    for (const binding of apiBindings) {\n      bindingsMap[binding.ref] = {\n        type: binding.type,\n        method: binding.resolved.method,\n        path: binding.resolved.path,\n      };\n    }\n  }\n\n  function handler(event) {\n    if (!event.data || event.data.type !== 'ncodes:api-request') {\n      // Listen for sandbox error forwarding\n      if (event.data && event.data.type === 'ncodes:sandbox-error') {\n        console.error('[n.codes:sandbox] Error in generated code:', event.data.message,\n          'line:', event.data.lineno);\n      }\n      return;\n    }\n\n    // Validate source \u2014 must come from our iframe\n    if (iframe.contentWindow && event.source !== iframe.contentWindow) return;\n\n    const { id, method, ref, params, data } = event.data;\n    if (!id || !ref) return;\n\n    console.log('[n.codes:handler] request received', { id, method, ref });\n    handleRequest(id, method, ref, params, data);\n  }\n\n  async function handleRequest(id, method, ref, params, data) {\n    try {\n      // Validate ref against whitelist\n      const binding = bindingsMap[ref];\n      if (!binding) {\n        console.warn('[n.codes:handler] unknown ref', ref, 'available:', Object.keys(bindingsMap));\n        sendResponse(id, null, 'Unknown API reference: ' + ref);\n        return;\n      }\n\n      console.log('[n.codes:handler] ref resolved', { ref, path: binding.path, method: binding.method });\n\n      // Validate method type matches\n      if (method === 'query' && binding.type !== 'query') {\n        sendResponse(id, null, 'Reference \"' + ref + '\" is not a query');\n        return;\n      }\n      if (method === 'action' && binding.type !== 'action') {\n        sendResponse(id, null, 'Reference \"' + ref + '\" is not an action');\n        return;\n      }\n\n      // Build fetch options\n      const fetchOpts = {\n        credentials: 'include',\n      };\n\n      let url = binding.path;\n\n      if (binding.method === 'GET') {\n        // Append params as query string\n        if (params && Object.keys(params).length > 0) {\n          const searchParams = new URLSearchParams();\n          for (const [key, value] of Object.entries(params)) {\n            if (value != null) searchParams.append(key, String(value));\n          }\n          const sep = url.includes('?') ? '&' : '?';\n          url = url + sep + searchParams.toString();\n        }\n        fetchOpts.method = 'GET';\n      } else {\n        fetchOpts.method = binding.method;\n        fetchOpts.headers = { 'Content-Type': 'application/json' };\n        fetchOpts.body = JSON.stringify(data || params || {});\n      }\n\n      const response = await doFetch(url, fetchOpts);\n      console.log('[n.codes:handler] fetch complete', { id, ref, status: response.status, ok: response.ok });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(function() { return {}; });\n        const errorMsg = (errorData && errorData.error) || 'Request failed (' + response.status + ')';\n        sendResponse(id, null, errorMsg);\n        return;\n      }\n\n      const responseData = await response.json();\n      sendResponse(id, responseData, null);\n    } catch (err) {\n      sendResponse(id, null, err.message || 'Network error');\n    }\n  }\n\n  function sendResponse(id, data, error) {\n    console.log('[n.codes:handler] response sent', { id, hasData: !!data, error: error || null });\n    if (!iframe.contentWindow) return;\n    iframe.contentWindow.postMessage({\n      type: 'ncodes:api-response',\n      id: id,\n      data: data,\n      error: error,\n    // targetOrigin '*' is required here: srcdoc iframes have an opaque\n    // origin (null), so there is no specific origin we can target.\n    // The sandbox=\"allow-scripts\" (without allow-same-origin) ensures\n    // the iframe cannot access the parent's DOM or storage.\n    }, '*');\n  }\n\n  function start() {\n    window.addEventListener('message', handler);\n  }\n\n  function stop() {\n    window.removeEventListener('message', handler);\n  }\n\n  return { start, stop, handler };\n}\n\nmodule.exports = { createMessageHandler };\n", "'use strict';\n\n/**\n * Sandbox renderer \u2014 creates a secure iframe to render\n * LLM-generated HTML/CSS/JS with an API bridge.\n */\n\nconst { getBridgeScript } = require('./api-bridge');\nconst { createMessageHandler } = require('./message-handler');\n\n// Track active sandbox for cleanup\nlet _activeSandbox = null;\n\n/**\n * Create a sandboxed iframe and render generated code.\n *\n * @param {HTMLElement} container - Parent element to attach the iframe to\n * @param {object} content - Generated content from the server\n * @param {string} content.html - Generated HTML markup\n * @param {string} content.css - Generated CSS styles\n * @param {string} content.js - Generated JavaScript\n * @param {Array} content.apiBindings - API binding whitelist\n * @param {object} [options]\n * @param {object} [options.appInfo] - App info for the bridge (name, entities)\n * @param {function} [options.fetchFn] - Custom fetch for testing\n * @returns {{ iframe: HTMLIFrameElement, destroy: function }}\n */\nfunction createSandbox(container, content, options) {\n  // Clean up any existing sandbox first\n  destroyActiveSandbox();\n\n  const opts = options || {};\n  const { html, css, js, apiBindings } = content;\n\n  // Create iframe\n  const iframe = document.createElement('iframe');\n  iframe.setAttribute('sandbox', 'allow-scripts');\n  iframe.style.width = '100%';\n  iframe.style.height = '100%';\n  iframe.style.border = 'none';\n  iframe.style.display = 'block';\n  iframe.style.backgroundColor = 'transparent';\n\n  // Build srcdoc: bridge script + CSS + HTML + generated JS\n  const bridgeScript = getBridgeScript(opts.appInfo);\n  const srcdoc = buildSrcdoc(bridgeScript, html || '', css || '', js || '');\n  iframe.setAttribute('srcdoc', srcdoc);\n\n  // Set up message handler for API proxying\n  const messageHandler = createMessageHandler(iframe, apiBindings || [], {\n    fetchFn: opts.fetchFn,\n  });\n  messageHandler.start();\n\n  // Append to container\n  container.appendChild(iframe);\n\n  const sandbox = {\n    iframe: iframe,\n    messageHandler: messageHandler,\n    destroy: function() {\n      messageHandler.stop();\n      if (iframe.parentNode) {\n        iframe.parentNode.removeChild(iframe);\n      }\n      if (_activeSandbox === sandbox) {\n        _activeSandbox = null;\n      }\n    },\n  };\n\n  _activeSandbox = sandbox;\n  return sandbox;\n}\n\n/**\n * Build the srcdoc HTML string for the iframe.\n *\n * @param {string} bridgeScript - The API bridge JavaScript\n * @param {string} html - Generated HTML content\n * @param {string} css - Generated CSS styles\n * @param {string} js - Generated JavaScript\n * @returns {string} Complete HTML document for srcdoc\n */\nfunction buildSrcdoc(bridgeScript, html, css, js) {\n  return '<!DOCTYPE html>'\n    + '<html><head><meta charset=\"utf-8\">'\n    + '<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">'\n    + '<style>'\n    + '*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }'\n    + 'body { font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif; '\n    + 'color: #ededed; background: transparent; padding: 16px; }'\n    + '</style>'\n    + (css ? '<style>' + css + '</style>' : '')\n    + '<script>' + bridgeScript + '<\\/script>'\n    + '</head><body>'\n    + html\n    + (js ? '<script>' + js + '<\\/script>' : '')\n    + '</body></html>';\n}\n\n/**\n * Destroy the currently active sandbox, if any.\n */\nfunction destroyActiveSandbox() {\n  if (_activeSandbox) {\n    _activeSandbox.destroy();\n    _activeSandbox = null;\n  }\n}\n\n/**\n * Get the currently active sandbox (for testing).\n * @returns {object|null}\n */\nfunction getActiveSandbox() {\n  return _activeSandbox;\n}\n\nmodule.exports = { createSandbox, destroyActiveSandbox, getActiveSandbox, buildSrcdoc };\n", "/**\n * Renders generated UI content into a container element.\n *\n * Rendering path:\n *   renderGenerated() \u2014 renders LLM-generated HTML/CSS/JS in a sandboxed iframe\n */\n\nconst { createSandbox, destroyActiveSandbox } = require('./sandbox');\n\n/**\n * Render LLM-generated code in a sandboxed iframe.\n *\n * @param {HTMLElement} container - Target DOM element\n * @param {object} content - Server response content\n * @param {string} content.html - Generated HTML\n * @param {string} content.css - Generated CSS\n * @param {string} content.js - Generated JS\n * @param {Array} content.apiBindings - API binding whitelist\n * @param {object} [options]\n * @param {object} [options.appInfo] - App info for the bridge\n * @param {function} [options.fetchFn] - Custom fetch for testing\n * @returns {{ iframe, destroy }}\n */\nfunction renderGenerated(container, content, options) {\n  clearRenderedUI(container);\n  return createSandbox(container, content, options);\n}\n\nfunction clearRenderedUI(container) {\n  if (!container) return;\n  destroyActiveSandbox();\n  while (container.firstChild) {\n    container.removeChild(container.firstChild);\n  }\n}\n\nmodule.exports = { renderGenerated, clearRenderedUI };\n", "/**\n * Feature history \u2014 persists generated features in localStorage.\n */\n\nconst STORAGE_KEY = 'ncodes:history';\nconst MAX_ENTRIES = 20;\n\nfunction getHistory() {\n  try {\n    const raw = localStorage.getItem(STORAGE_KEY);\n    if (!raw) return [];\n    const parsed = JSON.parse(raw);\n    if (!Array.isArray(parsed)) return [];\n    return parsed;\n  } catch {\n    return [];\n  }\n}\n\nfunction addToHistory({ prompt, generated }) {\n  const history = getHistory();\n  const entry = {\n    id: String(Date.now()),\n    prompt,\n    timestamp: Date.now(),\n  };\n  // Store generated content for live mode entries (replay without re-calling API)\n  if (generated) {\n    entry.generated = generated;\n  }\n  history.unshift(entry);\n  if (history.length > MAX_ENTRIES) {\n    history.length = MAX_ENTRIES;\n  }\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(history));\n  return entry;\n}\n\nfunction removeFromHistory(id) {\n  const history = getHistory().filter((item) => item.id !== id);\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(history));\n  return history;\n}\n\nfunction clearHistory() {\n  localStorage.removeItem(STORAGE_KEY);\n}\n\nmodule.exports = { getHistory, addToHistory, removeFromHistory, clearHistory, STORAGE_KEY, MAX_ENTRIES };\n", "/**\n * API client for the n.codes generate endpoint.\n * Handles retries, timeouts, and error classification.\n */\n\nconst DEFAULT_TIMEOUT = 30000;\nconst MAX_RETRIES = 3;\nconst BASE_DELAY = 1000;\n\n/**\n * Call POST /api/generate with retry and timeout logic.\n *\n * @param {string} apiUrl - API endpoint URL\n * @param {object} body - Request body { prompt, provider, model }\n * @param {object} [options]\n * @param {number} [options.timeout] - Request timeout in ms (default 30000)\n * @param {number} [options.maxRetries] - Max retries (default 3)\n * @param {function} [options.fetchFn] - Custom fetch function (for testing)\n * @returns {Promise<{ dsl: object, reasoning: string, tokensUsed: number }>}\n * @throws {GenerateError}\n */\nasync function callGenerateAPI(apiUrl, body, options = {}) {\n  const {\n    timeout = DEFAULT_TIMEOUT,\n    maxRetries = MAX_RETRIES,\n    fetchFn,\n  } = options;\n  const doFetch = fetchFn || globalThis.fetch;\n\n  let lastError;\n\n  for (let attempt = 0; attempt <= maxRetries; attempt++) {\n    if (attempt > 0) {\n      const delay = BASE_DELAY * Math.pow(2, attempt - 1);\n      await sleep(delay);\n    }\n\n    try {\n      const result = await fetchWithTimeout(doFetch, apiUrl, body, timeout);\n      return result;\n    } catch (err) {\n      lastError = err;\n      // Don't retry client errors (4xx) \u2014 they won't succeed on retry\n      if (err instanceof GenerateError && err.status >= 400 && err.status < 500) {\n        throw err;\n      }\n      // Retry on network errors, timeouts, and server errors (5xx)\n    }\n  }\n\n  throw lastError;\n}\n\nasync function fetchWithTimeout(doFetch, apiUrl, body, timeout) {\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), timeout);\n\n  try {\n    const response = await doFetch(apiUrl, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(body),\n      signal: controller.signal,\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      const message = classifyError(response.status, errorData);\n      throw new GenerateError(message, response.status, errorData);\n    }\n\n    return response.json();\n  } catch (err) {\n    if (err instanceof GenerateError) throw err;\n    if (err.name === 'AbortError') {\n      throw new GenerateError('Request timed out. The AI is taking too long to respond.', 0, null);\n    }\n    throw new GenerateError(\n      'Network error. Please check your connection and try again.',\n      0,\n      null\n    );\n  } finally {\n    clearTimeout(timeoutId);\n  }\n}\n\n/**\n * Map HTTP status + error data to a user-friendly message.\n */\nfunction classifyError(status, errorData) {\n  const serverMsg = errorData && errorData.error;\n\n  if (status === 401) {\n    return 'API key is missing or invalid. Please check your configuration.';\n  }\n  if (status === 400) {\n    return serverMsg || 'Invalid request. Please try a different prompt.';\n  }\n  if (status === 422) {\n    return 'The AI generated an invalid response. Please try again.';\n  }\n  if (status === 429) {\n    return 'Rate limit exceeded. Please wait a moment and try again.';\n  }\n  if (status >= 500) {\n    return 'Server error. The AI service may be temporarily unavailable.';\n  }\n  return serverMsg || `Unexpected error (${status}).`;\n}\n\nclass GenerateError extends Error {\n  constructor(message, status, data) {\n    super(message);\n    this.name = 'GenerateError';\n    this.status = status;\n    this.data = data;\n  }\n}\n\nconst DEFAULT_POLL_INTERVAL = 2000;\nconst DEFAULT_MAX_POLL_DURATION = 5 * 60 * 1000; // 5 minutes\n\n/**\n * Poll GET /api/jobs/:jobId until the job completes, fails, or needs clarification.\n *\n * @param {string} apiUrl - Base API URL (e.g., \"http://localhost:3001\")\n * @param {string} jobId - Job ID returned from POST /api/generate\n * @param {object} [options]\n * @param {number} [options.interval] - Poll interval in ms (default 2000)\n * @param {number} [options.maxDuration] - Max total poll duration in ms (default 5 min)\n * @param {function} [options.onProgress] - Callback: onProgress(step) for UI updates\n * @param {function} [options.fetchFn] - Custom fetch function (for testing)\n * @returns {Promise<object>} - Resolved result or clarification data\n * @throws {GenerateError}\n */\nasync function pollJobStatus(apiUrl, jobId, options = {}) {\n  const {\n    interval = DEFAULT_POLL_INTERVAL,\n    maxDuration = DEFAULT_MAX_POLL_DURATION,\n    onProgress,\n    fetchFn,\n  } = options;\n  const doFetch = fetchFn || globalThis.fetch;\n\n  // Normalize base URL: strip trailing /api/generate if present\n  const baseUrl = apiUrl.replace(/\\/api\\/generate\\/?$/, '');\n  const pollUrl = `${baseUrl}/api/jobs/${jobId}`;\n\n  const startTime = Date.now();\n\n  while (true) {\n    const elapsed = Date.now() - startTime;\n    if (elapsed >= maxDuration) {\n      throw new GenerateError(\n        'Generation is taking longer than expected. Please try again.',\n        0,\n        null\n      );\n    }\n\n    let data;\n    try {\n      const response = await doFetch(pollUrl);\n      if (!response.ok) {\n        if (response.status === 404) {\n          throw new GenerateError('Job not found. It may have expired.', 404, null);\n        }\n        const errorData = await response.json().catch(() => ({}));\n        throw new GenerateError(\n          errorData.error || `Polling error (${response.status})`,\n          response.status,\n          errorData\n        );\n      }\n      data = await response.json();\n    } catch (err) {\n      if (err instanceof GenerateError) throw err;\n      throw new GenerateError(\n        'Network error while checking generation status.',\n        0,\n        null\n      );\n    }\n\n    if (data.status === 'running') {\n      if (data.step && typeof onProgress === 'function') {\n        onProgress(data.step);\n      }\n      await sleep(interval);\n      continue;\n    }\n\n    if (data.status === 'completed') {\n      return data.result;\n    }\n\n    if (data.status === 'clarification') {\n      return data.result;\n    }\n\n    if (data.status === 'failed') {\n      throw new GenerateError(\n        data.error || 'Generation failed. Please try again.',\n        0,\n        null\n      );\n    }\n\n    // Unknown status \u2014 treat as error\n    throw new GenerateError(\n      `Unexpected job status: ${data.status}`,\n      0,\n      null\n    );\n  }\n}\n\nfunction sleep(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nmodule.exports = {\n  callGenerateAPI,\n  pollJobStatus,\n  GenerateError,\n  classifyError,\n  DEFAULT_TIMEOUT,\n  MAX_RETRIES,\n  BASE_DELAY,\n  DEFAULT_POLL_INTERVAL,\n  DEFAULT_MAX_POLL_DURATION,\n};\n", "/**\n * n.codes Widget SDK\n *\n * Public API:\n *   NCodes.init(config)  \u2014 Initialize the widget\n *   NCodes.open()        \u2014 Open the prompt panel\n *   NCodes.close()       \u2014 Close the prompt panel\n *   NCodes.destroy()     \u2014 Remove the widget entirely\n */\n\nconst { mergeConfig } = require('./config');\nconst { getStyles } = require('./styles');\nconst { createTrigger } = require('./trigger');\nconst {\n  createPanel,\n  openPanel,\n  closePanel,\n  showResultView,\n  showPromptView,\n  getResultContainer,\n  updateHistoryList,\n} = require('./panel');\nconst { renderGenerated, clearRenderedUI } = require('./renderer');\nconst { getHistory, addToHistory, removeFromHistory } = require('./history');\nconst { callGenerateAPI, pollJobStatus } = require('./api-client');\n\nlet _state = null;\n\nfunction init(userConfig) {\n  if (_state) {\n    destroy();\n  }\n\n  const config = mergeConfig(userConfig);\n\n  // If no user is provided, the widget stays hidden (auth gate)\n  if (!config.user) {\n    _state = { config, mounted: false };\n    return;\n  }\n\n  // Register CSS custom property for glow animation (must be document-level, not Shadow DOM)\n  if (typeof CSS !== 'undefined' && CSS.registerProperty) {\n    try {\n      CSS.registerProperty({\n        name: '--ncodes-glow-angle',\n        syntax: '<angle>',\n        initialValue: '0deg',\n        inherits: false,\n      });\n    } catch (_) {\n      // Already registered or unsupported \u2014 safe to ignore\n    }\n  }\n\n  // Create shadow DOM host\n  const host = document.createElement('div');\n  host.id = 'ncodes-root';\n  const shadow = host.attachShadow({ mode: 'open' });\n\n  // Inject styles (generated UI now renders inside sandboxed iframe, no DSL styles needed)\n  const styleEl = document.createElement('style');\n  const resolvedTheme = config.theme === 'auto'\n    ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')\n    : config.theme;\n  styleEl.textContent = getStyles(resolvedTheme);\n  shadow.appendChild(styleEl);\n\n  // Create trigger and panel\n  const trigger = createTrigger(config, () => {\n    openPanel(panel, trigger);\n  });\n\n  const panel = createPanel(config);\n\n  shadow.appendChild(trigger);\n  shadow.appendChild(panel);\n  document.body.appendChild(host);\n\n  _state = {\n    config,\n    host,\n    shadow,\n    trigger,\n    panel,\n    mounted: true,\n    isGenerating: false,\n  };\n\n  // Wire up panel event listeners\n  wireEvents();\n\n  // Load history on init\n  refreshHistoryList();\n\n}\n\nfunction wireEvents() {\n  if (!_state || !_state.mounted) return;\n  const { panel, trigger } = _state;\n\n  // Panel close button\n  const closeBtn = panel.querySelector('[data-ncodes-panel-close]');\n  if (closeBtn) {\n    closeBtn.addEventListener('click', () => closePanel(panel, trigger));\n  }\n\n  // Generate button\n  const generateBtn = panel.querySelector('.generate-btn');\n  if (generateBtn) {\n    generateBtn.addEventListener('click', handleGenerate);\n  }\n\n  // Enter key in textarea\n  const textarea = panel.querySelector('.prompt-input');\n  if (textarea) {\n    textarea.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter' && !e.shiftKey) {\n        e.preventDefault();\n        handleGenerate();\n      }\n    });\n  }\n\n  // Quick prompt buttons (static ones from config)\n  wireQuickPromptClicks();\n\n  // History list \u2014 event delegation for clicks and deletes\n  const historyList = panel.querySelector('.history-list');\n  if (historyList) {\n    historyList.addEventListener('click', handleHistoryClick);\n  }\n\n  // Result view back button\n  const backBtn = panel.querySelector('[data-ncodes-back]');\n  if (backBtn) {\n    backBtn.addEventListener('click', handleBack);\n  }\n\n  // Close on escape\n  document.addEventListener('keydown', handleEscapeKey);\n\n  // Close on click outside\n  document.addEventListener('click', handleOutsideClick);\n}\n\nfunction wireQuickPromptClicks() {\n  if (!_state || !_state.mounted) return;\n  const quickBtns = _state.panel.querySelectorAll('.quick-prompt');\n  quickBtns.forEach((btn) => {\n    btn.addEventListener('click', () => {\n      const input = _state.panel.querySelector('.prompt-input');\n      if (input) {\n        input.value = btn.getAttribute('data-prompt');\n        input.focus();\n      }\n    });\n  });\n}\n\nfunction handleEscapeKey(e) {\n  if (!_state || !_state.mounted) return;\n  if (e.key !== 'Escape') return;\n  if (!_state.panel.classList.contains('open')) return;\n\n  // If in result view, go back to prompt view first\n  if (_state.panel.classList.contains('expanded')) {\n    handleBack();\n  } else {\n    closePanel(_state.panel, _state.trigger);\n  }\n}\n\nfunction handleOutsideClick(e) {\n  if (!_state || !_state.mounted) return;\n  // The host element catches clicks that go through the shadow DOM\n  if (_state.panel.classList.contains('open') && !_state.host.contains(e.target)) {\n    closePanel(_state.panel, _state.trigger);\n  }\n}\n\nfunction handleBack() {\n  if (!_state || !_state.mounted) return;\n  const container = getResultContainer(_state.panel);\n  clearRenderedUI(container);\n  showPromptView(_state.panel);\n}\n\nfunction handleHistoryClick(e) {\n  if (!_state || !_state.mounted) return;\n\n  // Check if delete button was clicked\n  const deleteBtn = e.target.closest('[data-history-delete]');\n  if (deleteBtn) {\n    e.stopPropagation();\n    const id = deleteBtn.getAttribute('data-history-delete');\n    removeFromHistory(id);\n    refreshHistoryList();\n    return;\n  }\n\n  // Check if a history item row was clicked\n  const item = e.target.closest('.history-item');\n  if (item) {\n    const historyId = item.getAttribute('data-history-id');\n    const promptText = item.querySelector('.history-prompt-text');\n    const prompt = promptText ? promptText.textContent : '';\n    showHistoryResult(historyId, prompt);\n  }\n}\n\nfunction showHistoryResult(historyId, promptText) {\n  if (!_state || !_state.mounted) return;\n\n  const history = getHistory();\n  const entry = history.find((h) => h.id === historyId);\n\n  const container = getResultContainer(_state.panel);\n  clearRenderedUI(container);\n\n  if (entry && entry.generated) {\n    // Live mode entry \u2014 re-render stored generated code in sandbox\n    renderGenerated(container, {\n      html: entry.generated.html,\n      css: entry.generated.css,\n      js: entry.generated.js,\n      apiBindings: entry.generated.apiBindings,\n    });\n  } else {\n    const generateBtn = _state.panel.querySelector('.generate-btn');\n    const textarea = _state.panel.querySelector('.prompt-input');\n    showErrorState(\n      \"This entry can't be replayed anymore. Please regenerate.\",\n      promptText,\n      generateBtn,\n      textarea\n    );\n    return;\n  }\n\n  showResultView(_state.panel, promptText);\n}\n\nasync function handleGenerate() {\n  if (!_state || !_state.mounted || _state.isGenerating) return;\n\n  const textarea = _state.panel.querySelector('.prompt-input');\n  const prompt = textarea ? textarea.value.trim() : '';\n  if (!prompt) return;\n\n  _state.isGenerating = true;\n\n  const generateBtn = _state.panel.querySelector('.generate-btn');\n  if (generateBtn) {\n    generateBtn.disabled = true;\n    const btnText = generateBtn.querySelector('.btn-text');\n    const btnLoading = generateBtn.querySelector('.btn-loading');\n    if (btnText) btnText.style.display = 'none';\n    if (btnLoading) btnLoading.style.display = 'flex';\n  }\n\n  await handleGenerateLive(prompt, generateBtn, textarea);\n\n  _state.isGenerating = false;\n}\n\n/** Step-specific status messages shown during polling. */\nconst STEP_MESSAGES = {\n  intent: 'Understanding your request...',\n  feasibility: 'Checking what this app can do...',\n  codegen: 'Writing HTML, CSS & JavaScript...',\n  review: 'Reviewing generated code...',\n  iterate: 'Fixing issues found by QA...',\n  resolve: 'Resolving API connections...',\n};\n\n/**\n * Live mode: call API \u2192 poll for job completion \u2192 render generated HTML/CSS/JS in sandbox.\n * Handles clarifying questions from the server.\n * Shows step-level progress during polling, error state on failure.\n */\nasync function handleGenerateLive(prompt, generateBtn, textarea) {\n  showLoadingState('Generating... this usually takes 1-2 minutes');\n\n  try {\n    const { config } = _state;\n    const { jobId } = await callGenerateAPI(config.apiUrl, {\n      prompt,\n      provider: config.provider,\n      model: config.model,\n    });\n\n    // Poll for completion with step progress updates\n    const result = await pollJobStatus(config.apiUrl, jobId, {\n      onProgress(step) {\n        const message = STEP_MESSAGES[step] || 'Generating...';\n        updateStepProgress(step, message);\n      },\n    });\n\n    // Handle clarifying question response\n    if (result.clarifyingQuestion) {\n      hideLoadingState();\n      showClarifyingQuestion(result.clarifyingQuestion, result.options, prompt, generateBtn, textarea);\n      return;\n    }\n\n    // Save generated content to history\n    addToHistory({\n      prompt,\n      generated: {\n        html: result.html,\n        css: result.css,\n        js: result.js,\n        apiBindings: result.apiBindings,\n      },\n    });\n    refreshHistoryList();\n\n    // Render in sandbox\n    hideLoadingState();\n    const container = getResultContainer(_state.panel);\n    clearRenderedUI(container);\n    renderGenerated(container, {\n      html: result.html,\n      css: result.css,\n      js: result.js,\n      apiBindings: result.apiBindings,\n    });\n    showResultView(_state.panel, prompt);\n    resetGenerateUI(generateBtn, textarea);\n  } catch (err) {\n    hideLoadingState();\n    console.warn('[n.codes] Live generation failed:', err.message);\n    showErrorState(err.message, prompt, generateBtn, textarea);\n  }\n}\n\n/**\n * Show a clarifying question in the panel with clickable option buttons.\n */\nfunction showClarifyingQuestion(question, options, originalPrompt, generateBtn, textarea) {\n  if (!_state || !_state.mounted) return;\n\n  const container = getResultContainer(_state.panel);\n  clearRenderedUI(container);\n\n  const wrapper = document.createElement('div');\n  wrapper.className = 'ncodes-clarifying-question';\n\n  const questionEl = document.createElement('div');\n  questionEl.className = 'ncodes-clarifying-text';\n  questionEl.textContent = question;\n  wrapper.appendChild(questionEl);\n\n  if (Array.isArray(options) && options.length > 0) {\n    const optionsDiv = document.createElement('div');\n    optionsDiv.className = 'ncodes-clarifying-options';\n\n    options.forEach((option) => {\n      const btn = document.createElement('button');\n      btn.className = 'ncodes-clarifying-option';\n      btn.textContent = option;\n      btn.addEventListener('click', () => {\n        // Re-submit with the answer appended to the prompt\n        const newPrompt = originalPrompt + ' \u2014 ' + option;\n        if (textarea) textarea.value = newPrompt;\n        showPromptView(_state.panel);\n        resetGenerateUI(generateBtn, textarea);\n        _state.isGenerating = false;\n        handleGenerate();\n      });\n      optionsDiv.appendChild(btn);\n    });\n\n    wrapper.appendChild(optionsDiv);\n  }\n\n  container.appendChild(wrapper);\n  showResultView(_state.panel, originalPrompt);\n  resetGenerateUI(generateBtn, textarea);\n}\n\nfunction resetGenerateUI(generateBtn, textarea) {\n  if (generateBtn) {\n    generateBtn.disabled = false;\n    const btnText = generateBtn.querySelector('.btn-text');\n    const btnLoading = generateBtn.querySelector('.btn-loading');\n    if (btnText) btnText.style.display = 'inline';\n    if (btnLoading) btnLoading.style.display = 'none';\n  }\n  const statusEl = _state.panel.querySelector('.generation-status');\n  if (statusEl) statusEl.style.display = 'none';\n\n  if (textarea) textarea.value = '';\n}\n\nfunction showLoadingState(message) {\n  if (!_state || !_state.mounted) return;\n  const statusEl = _state.panel.querySelector('.generation-status');\n  const statusText = _state.panel.querySelector('.status-text');\n  const statusIcon = _state.panel.querySelector('.status-icon');\n  const stepEl = _state.panel.querySelector('.status-step');\n  if (statusEl) statusEl.style.display = 'block';\n  if (statusText) statusText.textContent = message || 'Generating with AI...';\n  if (statusIcon) statusIcon.classList.add('spinning');\n  if (stepEl) stepEl.textContent = '';\n}\n\nfunction updateStepProgress(step, message) {\n  if (!_state || !_state.mounted) return;\n  const statusText = _state.panel.querySelector('.status-text');\n  const stepEl = _state.panel.querySelector('.status-step');\n  if (statusText) statusText.textContent = message;\n  if (stepEl) stepEl.textContent = step;\n}\n\nfunction hideLoadingState() {\n  if (!_state || !_state.mounted) return;\n  const statusEl = _state.panel.querySelector('.generation-status');\n  if (statusEl) statusEl.style.display = 'none';\n}\n\nfunction showErrorState(message, prompt, generateBtn, textarea) {\n  if (!_state || !_state.mounted) return;\n\n  const container = getResultContainer(_state.panel);\n  clearRenderedUI(container);\n\n  // Build error UI using safe DOM APIs\n  const errorDiv = document.createElement('div');\n  errorDiv.className = 'ncodes-error-state';\n\n  const iconEl = document.createElement('div');\n  iconEl.className = 'ncodes-error-icon';\n  iconEl.textContent = '\\u26A0'; // warning sign\n\n  const msgEl = document.createElement('div');\n  msgEl.className = 'ncodes-error-message';\n  msgEl.textContent = message;\n\n  const actionsDiv = document.createElement('div');\n  actionsDiv.className = 'ncodes-error-actions';\n\n  const retryBtn = document.createElement('button');\n  retryBtn.className = 'ncodes-error-retry';\n  retryBtn.textContent = 'Try again';\n  retryBtn.addEventListener('click', () => {\n    // Re-populate textarea and re-trigger generation\n    if (textarea) textarea.value = prompt;\n    showPromptView(_state.panel);\n    resetGenerateUI(generateBtn, textarea);\n    _state.isGenerating = false;\n    handleGenerate();\n  });\n\n  actionsDiv.appendChild(retryBtn);\n\n  errorDiv.appendChild(iconEl);\n  errorDiv.appendChild(msgEl);\n  errorDiv.appendChild(actionsDiv);\n  container.appendChild(errorDiv);\n\n  showResultView(_state.panel, prompt);\n  resetGenerateUI(generateBtn, textarea);\n}\n\nfunction refreshHistoryList() {\n  if (!_state || !_state.mounted) return;\n  const history = getHistory();\n  updateHistoryList(_state.panel, history);\n}\n\nfunction open() {\n  if (!_state || !_state.mounted) return;\n  openPanel(_state.panel, _state.trigger);\n}\n\nfunction close() {\n  if (!_state || !_state.mounted) return;\n  closePanel(_state.panel, _state.trigger);\n}\n\nfunction destroy() {\n  if (!_state) return;\n\n  document.removeEventListener('keydown', handleEscapeKey);\n  document.removeEventListener('click', handleOutsideClick);\n\n  if (_state.host && _state.host.parentNode) {\n    _state.host.parentNode.removeChild(_state.host);\n  }\n\n  _state = null;\n}\n\nmodule.exports = { init, open, close, destroy };\n"],
  "mappings": "+EAAA,IAAAA,EAAAC,EAAA,CAAAC,GAAAC,IAAA,CAIA,IAAMC,EAAW,CACf,KAAM,KACN,OAAQ,gBACR,SAAU,SACV,MAAO,aACP,MAAO,OACP,SAAU,gBACV,aAAc,gBACd,WAAY,UACZ,WAAY,+DACZ,aAAc,CAAC,CACjB,EAEMC,EAAe,IAAI,IAAI,CAAC,OAAQ,QAAS,MAAM,CAAC,EAChDC,EAAkB,IAAI,IAAI,CAAC,gBAAiB,eAAgB,aAAa,CAAC,EAEhF,SAASC,EAAeC,EAAQ,CAC9B,GAAI,CAACA,GAAU,OAAOA,GAAW,SAC/B,MAAM,IAAI,MAAM,yCAAyC,EAE3D,GAAIA,EAAO,MAAQA,EAAO,OAAS,OACjC,MAAM,IAAI,MAAM,0EAA0E,EAE5F,GAAIA,EAAO,OAAS,CAACH,EAAa,IAAIG,EAAO,KAAK,EAChD,MAAM,IAAI,MAAM,kBAAkBA,EAAO,KAAK,WAAW,MAAM,KAAKH,CAAY,EAAE,KAAK,IAAI,CAAC,EAAE,EAEhG,GAAIG,EAAO,UAAY,CAACF,EAAgB,IAAIE,EAAO,QAAQ,EACzD,MAAM,IAAI,MAAM,qBAAqBA,EAAO,QAAQ,WAAW,MAAM,KAAKF,CAAe,EAAE,KAAK,IAAI,CAAC,EAAE,EAEzG,MAAO,EACT,CAEA,SAASG,GAAYC,EAAY,CAC/B,OAAAH,EAAeG,CAAU,EAClB,CAAE,GAAGN,EAAU,GAAGM,CAAW,CACtC,CAEAP,EAAO,QAAU,CAAE,SAAAC,EAAU,eAAAG,EAAgB,YAAAE,EAAY,ICzCzD,IAAAE,GAAAC,EAAA,CAAAC,GAAAC,KAAA,CAKA,SAASC,GAAUC,EAAO,CAqCxB,MAAO;AAAA;AAAA,QApCQA,IAAU,QAEH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAgBlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAoBM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA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",
  "names": ["require_config", "__commonJSMin", "exports", "module", "DEFAULTS", "VALID_THEMES", "VALID_POSITIONS", "validateConfig", "config", "mergeConfig", "userConfig", "require_styles", "__commonJSMin", "exports", "module", "getStyles", "theme", "require_trigger", "__commonJSMin", "exports", "module", "createTriggerIcon", "svg", "path1", "path2", "createTrigger", "config", "onClickHandler", "btn", "label", "showTrigger", "trigger", "hideTrigger", "require_panel", "__commonJSMin", "exports", "module", "createPanel", "config", "panel", "header", "title", "logo", "titleText", "closeBtn", "body", "promptView", "intro", "introP", "historySection", "historyLabel", "historyList", "promptSection", "textarea", "generateBtn", "btnText", "btnLoading", "i", "dot", "quickSection", "quickLabel", "qp", "btn", "status", "statusLine", "statusIcon", "statusText", "statusStep", "resultView", "resultHeader", "backBtn", "resultPromptLabel", "resultContent", "openPanel", "trigger", "input", "closePanel", "showPromptView", "resetPanelState", "clearChildren", "el", "showResultView", "promptText", "label", "getResultContainer", "updateHistoryList", "history", "section", "list", "item", "row", "text", "deleteBtn", "updateQuickPrompts", "prompts", "existing", "require_api_bridge", "__commonJSMin", "exports", "module", "getBridgeScript", "appInfo", "require_message_handler", "__commonJSMin", "exports", "module", "createMessageHandler", "iframe", "apiBindings", "options", "doFetch", "bindingsMap", "binding", "handler", "event", "id", "method", "ref", "params", "data", "handleRequest", "sendResponse", "fetchOpts", "url", "searchParams", "key", "value", "sep", "response", "errorData", "errorMsg", "responseData", "err", "error", "start", "stop", "require_sandbox", "__commonJSMin", "exports", "module", "getBridgeScript", "createMessageHandler", "_activeSandbox", "createSandbox", "container", "content", "options", "destroyActiveSandbox", "opts", "html", "css", "js", "apiBindings", "iframe", "bridgeScript", "srcdoc", "buildSrcdoc", "messageHandler", "sandbox", "getActiveSandbox", "require_renderer", "__commonJSMin", "exports", "module", "createSandbox", "destroyActiveSandbox", "renderGenerated", "container", "content", "options", "clearRenderedUI", "require_history", "__commonJSMin", "exports", "module", "STORAGE_KEY", "getHistory", "raw", "parsed", "addToHistory", "prompt", "generated", "history", "entry", "removeFromHistory", "id", "item", "clearHistory", "require_api_client", "__commonJSMin", "exports", "module", "callGenerateAPI", "apiUrl", "body", "options", "timeout", "maxRetries", "fetchFn", "doFetch", "lastError", "attempt", "delay", "sleep", "fetchWithTimeout", "err", "GenerateError", "controller", "timeoutId", "response", "errorData", "message", "classifyError", "status", "serverMsg", "data", "DEFAULT_POLL_INTERVAL", "DEFAULT_MAX_POLL_DURATION", "pollJobStatus", "jobId", "interval", "maxDuration", "onProgress", "pollUrl", "startTime", "ms", "resolve", "require_src", "__commonJSMin", "exports", "module", "mergeConfig", "getStyles", "createTrigger", "createPanel", "openPanel", "closePanel", "showResultView", "showPromptView", "getResultContainer", "updateHistoryList", "renderGenerated", "clearRenderedUI", "getHistory", "addToHistory", "removeFromHistory", "callGenerateAPI", "pollJobStatus", "_state", "init", "userConfig", "destroy", "config", "host", "shadow", "styleEl", "resolvedTheme", "trigger", "panel", "wireEvents", "refreshHistoryList", "closeBtn", "generateBtn", "handleGenerate", "textarea", "e", "wireQuickPromptClicks", "historyList", "handleHistoryClick", "backBtn", "handleBack", "handleEscapeKey", "handleOutsideClick", "btn", "input", "container", "deleteBtn", "id", "item", "historyId", "promptText", "prompt", "showHistoryResult", "entry", "h", "showErrorState", "btnText", "btnLoading", "handleGenerateLive", "STEP_MESSAGES", "showLoadingState", "jobId", "result", "step", "message", "updateStepProgress", "hideLoadingState", "showClarifyingQuestion", "resetGenerateUI", "err", "question", "options", "originalPrompt", "wrapper", "questionEl", "optionsDiv", "option", "newPrompt", "statusEl", "statusText", "statusIcon", "stepEl", "errorDiv", "iconEl", "msgEl", "actionsDiv", "retryBtn", "history", "open", "close"]
}
